# 2026-02-11 - Vercel Deployment & Affiliate Link Fix

## Session Summary

### Part 1: Vercel Deployment Fixes (20:14-20:56 GMT+1)
**Problem:** Vercel build failing with `react-scripts: command not found`

**Root Causes & Fixes:**
1. fiber-shop-landing was a git submodule â†’ Vercel couldn't access files
   - âœ… Removed submodule (git rm --cached, removed .git/modules)
   - âœ… Re-integrated as regular directory (commit a940ea6)

2. package-lock.json missing from git (in .gitignore)
   - âœ… Force-added package-lock.json (commit 6512857)

3. package-lock.json had macOS-specific deps (fsevents) â†’ Linux build failed
   - âœ… Regenerated lock file without platform-specific deps

4. Root package.json conflicting with fiber-shop-landing/package.json
   - âœ… Removed root package.json and node_modules
   - âœ… Left only fiber-shop-landing as deployment root

5. Vercel trying `npm ci` but package-lock had issues
   - âœ… Changed to `npm install --legacy-peer-deps` (more flexible)
   - âœ… Set via Vercel API (v8/projects endpoint)

**Key Commits:**
- a940ea6: re-integrate fiber-shop-landing as normal directory
- 6512857: regenerate package-lock.json (force add)
- fc15bb9: remove root package.json and node_modules
- fd07141: trigger deploy with npm install (not npm ci)

**Status:** âœ… Build now succeeds, Vercel deployment working

---

### Part 2: Affiliate Link Resolution (RESOLVED)
**Previous Issue:** Affiliate links from Fiber API returned 404
- Format was: `https://wild.link/e?d=rackroomshoes.com&u=...`

**Solution (Feb 23):**
- âœ… Fiber API now returns working affiliate_link URLs: `https://api.fiber.shop/r/w?c=123456&d=38604255&url=...`
- âœ… Removed `/api/redirect.js` (no longer needed)
- âœ… Updated all code to use affiliate_link directly from Fiber API
- âœ… Removed all wild.link references from codebase

**Status:** Affiliate links now work end-to-end. Users can click through to merchants with proper tracking.

## Technical Notes
- Vercel prefers `npm install` over `npm ci` for monorepos/complex deps
- Platform-specific packages (fsevents) cause cross-environment issues
- Git submodules are problematic for serverless deployments (Vercel, Netlify)

---

# 2026-02-13 - Fiber API v2 Updates

## Changes Implemented

**Fiber API Updates (Feb 13):**

1. **POST /v1/agent/register** - New fields:
   - âœ… `preferred_token` (optional) - agent can specify MON or BONK
   - âœ… Returns 409 Conflict if wallet already registered (with existing_agent_id)

2. **GET /v1/agent/search** - Changes:
   - âœ… `wallet` parameter now optional (uses registered wallet)
   - âœ… Affiliate links no longer return 404

3. **New Endpoints:**
   - âœ… GET /v1/agent/:agent_id/token - Get current token + available options
   - âœ… PUT /v1/agent/:agent_id/token - Change payout token

## Frontend Updates (Commit 2661748)

**Registration (Step 1):**
- Added token selection dropdown (MON, BONK, or auto-detect)
- Handle 409 Conflict gracefully (show "already registered" message)
- Auto-fetch available tokens after registration

**Search (Step 2):**
- Removed `wallet` parameter from queries (API uses registered wallet now)

**New Tab (ðŸ’° Token):**
- View current payout token
- Switch between available tokens
- Real-time token info fetching

**Backend handlers:**
- `handleGetTokenInfo()` - Fetch available & current token
- `handleChangeToken()` - Switch payout token
- Updated `handleRegisterAgent()` - Handle 409, capture token preferences

## Status
âœ… Frontend fully supports Fiber API v2
âœ… Affiliate links working
âœ… Multi-token support live
âœ… Agent conflict handling (409)

---

# 2026-02-13 - UI/UX Redesign (Futuristic Black/White)

## Design Complete
**Commit cfe8a23** - Complete CSS overhaul to match fiber.shop aesthetic

**Design System:**
- Colors: Black (#0a0a0a), White (#ffffff), Green (#00d084)
- Typography: SF Pro Display / Inter
- Borders: Minimal, high contrast (#333333)
- Shadows: Glassmorphism effects with green glow on hover
- Animations: Smooth transitions (150-350ms)
- Spacing: Consistent 8px grid

**Files Updated:**
1. `src/index.css` - Global theme variables & base styles
2. `src/styles/DemoPage.css` - Complete redesign
3. `src/styles/AgentApiDemo.css` - Modern component styling
4. `src/styles/LandingPage.css` - Hero, features, CTA sections

**Visual Changes:**
- âœ… Dark theme (black background)
- âœ… High contrast white text
- âœ… Green accent on hover & interactions
- âœ… Gradient backgrounds (subtle)
- âœ… Smooth 3D transforms on cards
- âœ… Modern input styling (focus states)
- âœ… Monospace fonts for data
- âœ… Responsive grid layouts

## Model Note
Laurent asked about Claude Opus 4.6 - you need to:
1. Update `/openclaw/config.json` to use opus model
2. Or run: `openclaw config.patch` with model setting
3. Gateway will restart automatically

I've done the design NOW without waiting for the model - the CSS is production-ready.

## All Pages Redesigned (Feb 13, 11:42 GMT+1)

**Commit 31515b7** - AgentPage & StatisticsPage

Complete redesign of ALL pages now live:
âœ… Landing Page â€” Hero, features, CTA
âœ… Demo Page â€” Registration, search, results
âœ… Agent Page â€” Dashboard, search, earnings, tips
âœ… Stats Page â€” KPIs, leaderboard, info

**Design System:**
- Pure black backgrounds
- White text with opacity layers
- Green accents (#00d084) only for:
  - Step numbers
  - Earnings/metrics
  - CTAs (secondary only)
- Section labels (uppercase, 11px, 0.3 opacity)
- Minimal borders (rgba 0.08)
- No emojis in headings
- Inter font throughout
- Consistent 60px padding between sections

**All Pages Match fiber.shop:**
- Tone: "Have your agent call my agent"
- Copy: Short, punchy, declarative
- UX: Minimal, clean, spacious
- Responsive on all devices

Status: Production-ready for launch.

